function get_url_parameters(){for(var t,e=[],o=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),n=0;n<o.length;n++)t=o[n].split("="),e.push(t[0]),e[t[0]]=t[1];return e}function saveNote(t,e){var o={_token:global_config.csrf_token,id:t,details:e};$.post(global_config.url_patch_note,o).done(function(t){1==t.status&&$.jGrowl(t.msg,{position:"bottom-right"})})}function deleteNote(t){var e={_token:global_config.csrf_token,id:t};$.post(global_config.url_delete_note,e).done(function(e){1==e.status&&($(".note_thread_"+t).remove(),$.jGrowl(e.msg,{position:"bottom-right"}))})}!function(t){function e(e){e.value.length>0&&t.when(a(e.value)).then(function(){$html=i(n()),t($html).insertAfter(e)})}function o(e){t(e).find("ul."+style.listHolderClass).remove()}function n(){return dataList}function a(e){var o=jQuery.Deferred();return t.isFunction(settings.source)?settings.source(e).done(function(t){t&&(dataList=t),o.resolve("hurray")}):(dataList=settings.source,o.resolve("hurray")),o.promise()}function i(e){var o=settings.fitToElement?"width:100%;":"",n='<ul class="'+style.listHolderClass+' dropdown-menu" role="listbox" style="top: 31px; left: 0px; display: block; height: auto; max-height: 350px; overflow-x: hidden; '+o+'">';return e.length>0?t.each(e,function(t,e){var o=settings.highlighter(e),a=settings.anchorLink?e[settings.anchorLink]:"#";n+='<li class="active"><a class="dropdown-item" href="'+a+'" role="option">'+o+"</a></li>"}):n+='<li class="active"><a class="dropdown-item" href="#" role="option">'+settings.noRecordFoundMessage+"</a></li>",n+="</ul>"}var l=function(t){return settings.displayText?t[settings.displayText]:t};settings={minLength:3,source:[],highlighter:l,displayText:null,anchorLink:null,fitToElement:!1,noRecordFoundMessage:"No record found"},style={listHolderClass:"micoSearch"},t.fn.micoSearch=function(n){return settings=t.extend({},settings,n),t(this).keyup(function(n){this.value&&(this.value=this.value.trim(),this.value.length<settings.minLength||(t(this).parent().find("ul."+style.listHolderClass).remove(),t(document).on("click",function(t){o(this)}),e(this)))}),this}}(jQuery),$(function(){$("#global_search").micoSearch({displayText:"label",anchorLink:"link",fitToElement:!0,noRecordFoundMessage:global_config.lang_no_record_found,source:function(t){return $.get(global_config.url_global_search,{query:t},function(t){return t})},highlighter:function(t){var e="<div>"+t.label+"</div>";return e=e+'<small id="emailHelp" class="form-text text-muted">'+t.type+"</small>"}})});var notificationListVueInstance=new Vue({el:"#notificationList",data:{notifications:[],loadingEnabled:!1},computed:{},methods:{showNotifications:function(){$scope=this,$("#notification_badge").html("").hide(),$scope.loadingEnabled=!0,$.post(global_config.url_get_unread_notifications,{_token:global_config.csrf_token}).done(function(t){$scope.notifications=t}).always(function(){$scope.loadingEnabled=!1})}}});$(document).on("click",".upload_link",function(t){t.preventDefault(),$("#attachment").trigger("click")}),$(document).on("change","#attachment",function(t){var e=$(this).data("form-id");e=e||"form";var o=$(this).data("short-code-input-id"),n=document.querySelector("#attachment"),a=new XMLHttpRequest;a.open("POST",global_config.url_upload_attachment),a.setRequestHeader("X-CSRF-Token",global_config.csrf_token),a.upload.onprogress=function(t){$("#uploading_on_progress").show()},a.onload=function(){$("#uploading_on_progress").hide();var t;if(200!=a.status)return void alert("Could not upload the attachment");if(!a.responseText)return void alert("Could not upload the attachment");if(t=JSON.parse(a.responseText),$key=Math.floor(1e3*Math.random()),$html='<li class="list-group-item">',$html+=o?' <a href="#" data-insert-in="'+o+'" data-short-code="'+t.short_code+'" class="insert_short_code"> '+t.display_name+" </a>":t.display_name,$html+=' <a href="'+t.name+'" data-key="'+$key+'" class="btn btn-danger btn-sm remove_tmp_attachment"> <i class="far fa-trash-alt"></i> </a>',$html+="</li>",$("#list_of_attachments").append($html),$("<input>").attr({type:"hidden",class:"attachment",name:"attachment["+$key+"]",value:t.encrypted_value_for_input}).appendTo(e),o){var n=$(o);n.val(n.val()+" "+t.short_code)}$(document).trigger("upload_complete")},4!=a.readyState||200!=a.status&&0!=a.status||console.log(a.responseText);var i=new FormData;i.append("file",n.files[0]),a.send(i)}),$(document).on("click",".remove_tmp_attachment",function(t){t.preventDefault();var e=$(this);e.data("key");$("input[name='attachment["+$key+"]']").remove(),e.parent().remove(),$.post(global_config.url_delete_temporary_attachment,{_token:global_config.csrf_token,filename:e.attr("href")}),$(document).trigger("tmp_attachment_removed")});var updateQueryStringParam=function(t,e){var o=[location.protocol,"//",location.host,location.pathname].join(""),n=document.location.search,a=t+"="+e,i="?"+a;n&&(updateRegex=new RegExp("([?&])"+t+"[^&]*"),removeRegex=new RegExp("([?&])"+t+"=[^&;]+[&;]?"),void 0===e||null==e||""==e?(i=n.replace(removeRegex,"$1"),i=i.replace(/[&;]$/,"")):i=null!==n.match(updateRegex)?n.replace(updateRegex,"$1"+a):n+"&"+a),window.history.replaceState({},"",o+i)};if($(function(){function t(t,e){$("#reportrange span").html(t.format("D , MMMM , YYYY")+" - "+e.format("MMMM D, YYYY"))}$('[data-toggle="tooltip"]').tooltip(),$("#sidebarCollapse").on("click",function(t){t.preventDefault(),$("#sidebar").toggleClass("active")}),$(".selectPickerWithoutSearch").select2({theme:"bootstrap",minimumResultsForSearch:-1,placeholder:function(){$(this).data("placeholder")},maximumSelectionSize:6}),$(".selectpicker").select2({theme:"bootstrap",placeholder:function(){$(this).data("placeholder")},maximumSelectionSize:6}),$(".select2-multiple").select2({theme:"bootstrap",placeholder:"Nothing Selected",maximumSelectionSize:6}),$(".four-boot").fourBoot(),ranges={Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")],"Last 12 Months":[moment().subtract(11,"month").startOf("month"),moment()]};var e=moment().startOf("month"),o=moment().endOf("month");$("#reportrange").daterangepicker({startDate:e,endDate:o,ranges:ranges,locale:{format:"MMM D, YYYY"}},t),t(e,o),$(".initially_empty_datepicker").daterangepicker({autoUpdateInput:!1,singleDatePicker:!0,showDropdowns:!0,locale:{format:"DD-MM-YYYY"}}).on("apply.daterangepicker",function(t,e){$(this).val(e.endDate.format("DD-MM-YYYY"))}),$(".datepickerAndTime").daterangepicker({timePicker:!0,singleDatePicker:!0,showDropdowns:!0,locale:{format:"DD-MM-YYYY hh:mm A"},startDate:moment()}),$(".datepicker").daterangepicker({singleDatePicker:!0,showDropdowns:!0,locale:{format:"DD-MM-YYYY"},startDate:moment()}),$(".dropdown-submenu > a").on("click",function(t){t.preventDefault();var e=$(this);$(".dropdown-submenu .dropdown-menu").removeClass("show"),e.next(".dropdown-menu").addClass("show"),t.stopPropagation()}),$(".dropdown").on("hidden.bs.dropdown",function(){$(".dropdown-menu.show").removeClass("show")})}),$(document).on("click",".delete_item",function(t){t.preventDefault();var e=$(this).attr("href");swal({title:global_config.txt_delete_confirm_title,text:global_config.txt_delete_confirm_text,icon:"warning",buttons:{cancel:{text:global_config.txt_btn_cancel,value:null,visible:!0,className:"",closeModal:!0},confirm:{text:global_config.txt_yes,value:!0,visible:!0,className:"",closeModal:!0}},dangerMode:!0}).then(function(t){t&&(window.location.href=e)})}),$(document).on("click",".insert_short_code",function(t){t.preventDefault();var e=$(this),o=e.data("short-code"),n=e.data("insert-in"),a=$(n);a.val(a.val()+" "+o)}),$(function(){function t(t){console.log("toggleNote : "+t);var e=$(".inlineEdit_"+t),o=$(".note_details_"+t);$(e).is(":hidden")?(e.show(),o.hide()):(e.hide(),o.show())}$(".editNote").click(function(e){e.preventDefault(),t($(this).data("id"))}),$(".saveNote").click(function(e){e.preventDefault();var o=$(this).data("id"),n=$(".inlineEdit_"+o).find("textarea[name=details]").val();$(".note_details_"+o).html(n),t(o),saveNote(o,n)})}),$(document).on("click",".delete_note",function(t){t.preventDefault(),id=$(this).data("id"),swal({title:global_config.txt_delete_confirm_title,text:global_config.txt_delete_confirm_text,icon:"warning",buttons:{cancel:{text:global_config.txt_btn_cancel,value:null,visible:!0,className:"",closeModal:!0},confirm:{text:global_config.txt_yes,value:!0,visible:!0,className:"",closeModal:!0}},dangerMode:!0}).then(function(t){t&&deleteNote(id)})}),global_config.is_pusher_enable){Pusher.logToConsole=global_config.pusher_log_status;var pusher=new Pusher(global_config.pusher_app_key,{cluster:global_config.pusher_cluster,forceTLS:!0}),channel=pusher.subscribe(global_config.pusher_channel);channel.bind("new.notification",function(t){var e=$("#notification_badge").text(),o=e?parseInt(e):0;$("#notification_badge").html(o+1).show()})}
